// import * as dfd from "danfojs"
import { weatherAPI } from './openMateoClient'
export * as DATA from "./dataManipulation";
import * as pattern from "patternomaly"

const COLORS = [["#FF9AA2", "#FF9AA295"],
    ["#FFDAC1", "#FFDAC195"],
    ["#B5EAD7", "#B5EAD795"],
    ["#C7CEEA", "#C7CEEA95"]
]


export async function getAllWeatherMetrics(options, zipCodeArr) {
    let locArr = [];
    for (const zipCode of zipCodeArr) {
            const locMetrics = await getLocationMetrics(options, zipCode);
            locArr.push(locMetrics);
    }
    // console.log(locArr);
    // let locArr = sampleArray;
    if (options.xStep !== 'days') {
        locArr = aggregateData(options.xStep, locArr);
    }
    return locArr;
    }
    
const aggregateData = (step, locArr) => {
    let timeArr = [];
    if (step === 'weeks') {
        timeArr = generateWeekArr(locArr[0]['weather']['time']);
    } else {
        timeArr = generateMonthArr(locArr[0]['weather']['time']);
    }

    for (let i = 0; i < locArr.length; i++) {
        locArr[i]["weather"]["temperature_2m_max"] = updateToAggData(timeArr, locArr[i]["weather"]["temperature_2m_max"]);
        locArr[i]["weather"]["temperature_2m_min"] = updateToAggData(timeArr, locArr[i]["weather"]["temperature_2m_min"]);
        locArr[i]["weather"]["snowfall_sum"] = updateToAggData(timeArr, locArr[i]["weather"]["snowfall_sum"]);
        locArr[i]["weather"]["rain_sum"] = updateToAggData(timeArr, locArr[i]["weather"]["rain_sum"]);
        locArr[i]["weather"]["sunrise"] = updateToAggData(timeArr, locArr[i]["weather"]["sunrise"]);
        locArr[i]["weather"]["sunset"] = updateToAggData(timeArr, locArr[i]["weather"]["sunset"]);
        locArr[i]["weather"]["daylight"] = updateToAggData(timeArr, locArr[i]["weather"]["daylight"]);
        locArr[i]["weather"]["time"] = updateToAggData(timeArr, locArr[i]["weather"]["time"]);
        
        locArr[i] = updateToAggData(timeArr, locArr[i])
    }
    
    return locArr;
}

const updateToAggData = (timeArr, locArr) => {
    const maxTemp = [];
    const minTemp = [];
    const snow =[];
    const rain = [];
    const sunrise = [];
    const sunset = [];
    const daylight = [];
    const time = [];
    let j = -1;
    let temp_count = 0;

    for (let i = 0; i < timeArr.length; i++) {
        if (i === 0 || timeArr[i] !== timeArr[i - 1]) {
            if (i > 0) {
                maxTemp[j] /= temp_count;
                minTemp[j] /= temp_count;
                snow[j] /= temp_count;
                rain[j] /= temp_count;
                sunrise[j] /= temp_count;
                sunset[j] /= temp_count;
                daylight[j] /= temp_count;
            }
            maxTemp.push(locArr["weather"]["temperature_2m_max"][i]);
            minTemp.push(locArr["weather"]["temperature_2m_min"][i]);
            snow.push(locArr["weather"]["snowfall_sum"][i]);
            rain.push(locArr["weather"]["rain_sum"][i]);
            sunrise.push(locArr["weather"]["sunrise"][i]);
            sunset.push(locArr["weather"]["sunset"][i]);
            daylight.push(locArr["weather"]["daylight"][i]);
            time.push(timeArr[i]);
            j += 1;
            temp_count = 1;
        } else {
            maxTemp[j] += locArr["weather"]["temperature_2m_max"][i]
            minTemp[j] += locArr["weather"]["temperature_2m_min"][i]
            snow[j] += locArr["weather"]["snowfall_sum"][i]
            rain[j] += locArr["weather"]["rain_sum"][i]
            sunrise[j] += locArr["weather"]["sunrise"][i]
            sunset[j] += locArr["weather"]["sunset"][i]
            daylight[j] += locArr["weather"]["daylight"][i]
            temp_count += 1
            if (i === timeArr.length - 1) {
                maxTemp[j] /= temp_count;
                minTemp[j] /= temp_count;
                snow[j] /= temp_count;
                rain[j] /= temp_count;
                sunrise[j] /= temp_count;
                sunset[j] /= temp_count;
                daylight[j] /= temp_count;
            }
        }
    }

    locArr["weather"]["temperature_2m_max"] = maxTemp;
    locArr["weather"]["temperature_2m_min"] = minTemp;
    locArr["weather"]["snowfall_sum"] = snow;
    locArr["weather"]["rain_sum"] = rain;
    locArr["weather"]["sunrise"] = sunrise;
    locArr["weather"]["sunset"] = sunset;
    locArr["weather"]["daylight"] = daylight.map(n => n < 0 ? 23.99 : n);
    locArr["weather"]["time"] = time;

    console.log(maxTemp);
    console.log(time);

    return locArr;

}

const generateMonthArr = (daysArr) => {
    const monthObj = {
        '01': 'Jan',
        '02': 'Feb',
        '03': 'Mar',
        '04': 'Apr',
        '05': 'May',
        '06': 'Jun',
        '07': 'Jul',
        '08': 'Aug',
        '09': 'Sep',
        '10': 'Oct',
        '11': 'Nov',
        '12': 'Dec',
    }

    return daysArr.map(el => monthObj[el.slice(5, 7)]);
}

const generateWeekArr = (daysArr) => {
    const weekArr = [daysArr[0]];
    for (let i = 1; i < daysArr.length; i++) {
        if (i % 7 === 0) {
            weekArr.push(daysArr[i])
        } else {
            weekArr.push(weekArr[i - 1])
        }
    }
    return weekArr;
}


export async function getLocationMetrics(options, zipCode) {
    const coordinates = await weatherAPI.getCoordinates(zipCode);
    const weather = await weatherAPI.getWeatherData(options, coordinates);
    const data = { "meta": coordinates, "weather": weather["daily"] };
    delete weather["daily"];
    data["meta"] = { ...coordinates, ...weather};
    console.log(data["weather"]); 
    for (const field of ["sunrise", "sunset"]) {
        data["weather"][field] = data["weather"][field].map(ts => extractHourFromTimestamp(ts));
    }
    data["weather"]["daylight"] = calcDaylight(data["weather"]["sunrise"],data["weather"]["sunset"])
    data["weather"]["snowfall_sum"] = data["weather"]["snowfall_sum"].map(x => 100 * x)
    
    if (options.imperialInd) {
        data["weather"] = convertToImperial(data["weather"]);
    }
    
    return data;
}

export const getPrecipYObj = (datasets) => {
    const obj = {
        stacked: true,
    }

    if (includesSnow(datasets)){
        obj.type = 'logarithmic';
    }
    return obj;
}

const includesSnow = (datasets) => {
    for (const dataset of datasets) {
        if (dataset['label'].includes('snow')) {
            if (dataset['data'].some(el => el !== 0)) return true;
        }
    }
    return false;
}


const calcDaylight = (sunriseArr, sunsetArr) => {
    const daylightArr = [];
    for (let i = 0; i < sunriseArr.length; i++) {
        daylightArr.push(sunsetArr[i] - sunriseArr[i]);
    }
    return daylightArr;
}

const convertToImperial = (weatherObj) => {
    console.log(weatherObj["temperature_2m_max"]);
    const toFrnArr = ["temperature_2m_max", "temperature_2m_min"]
    for (const field of toFrnArr) {
        weatherObj[field] = weatherObj[field].map(ts => convertCelsiusToFahrenheit(ts));
    }
    weatherObj["precipitation_sum"] = weatherObj["precipitation_sum"].map(x => convertMmToInches(x));
    weatherObj["rain_sum"] = weatherObj["rain_sum"].map(x => convertMmToInches(x));
    weatherObj["snowfall_sum"] = weatherObj["snowfall_sum"].map(x => convertMmToInches(x));
    return weatherObj;
}

const extractHourFromTimestamp = (ts) => {
    return Number(ts.slice(11, 13)) + Number(ts.slice(14, 16)) / 60
}

const convertCelsiusToFahrenheit = (temp) => {
    if (temp !== null) {
        return temp * 9/5 + 32;
    }
}

const convertMmToInches = (distance) => {
    return distance * 0.0393701;
}


export const createTempChartData = (locArr) => {
    let datasets = [];
    let i = 0;
    for (const loc of locArr) {
        datasets = datasets.concat([
            {
                label: "false",
                // backgroundColor: "#4787b5",
                showLine: false,
                pointStyle: false,
                data: loc["weather"]["temperature_2m_min"]
            },
            {
                label: loc["meta"]["name"],
                fill: '-1',
                showLine: false,
                pointStyle: false,
                data: loc["weather"]["temperature_2m_max"],
                borderColor: COLORS[i][0],
                backgroundColor: COLORS[i][1]
            }
        ])
        i += 1;
    }
    return datasets;
}

export const createPrecipChartData = (locArr) => {
    let datasets = [];
    let i = 0;
    for (const loc of locArr) {
        datasets = datasets.concat([
            {
                label: `${loc["meta"]["name"]} rain`,
                data: loc["weather"]["rain_sum"],
                stack: loc["meta"]["name"],
                backgroundColor: pattern.draw('dash',COLORS[i][1])
            },
            {
                label: `${loc["meta"]["name"]} snow`,
                data: loc["weather"]["snowfall_sum"],
                stack: loc["meta"]["name"],
                backgroundColor: pattern.draw('dot', COLORS[i][0])
            }
        ])
        i += 1;
    }
    return datasets;
}

export const createSunChartData = (locArr) => {
    let datasets = [];
    let i = 0;
    for (const loc of locArr) {
        datasets = datasets.concat([
            {
                label: `${loc["meta"]["name"]} sunrise`,
                data: loc["weather"]["sunrise"],
                backgroundColor: COLORS[i][0],
                borderColor: COLORS[i][1]
            },
            {
                label: `${loc["meta"]["name"]} sunset`,
                data: loc["weather"]["sunset"],
                backgroundColor: COLORS[i][0],
                borderColor: COLORS[i][1]
            }
        ])
        i += 1;
    }
    return datasets;
}


export const createDaylightChartData = (locArr) => {
    let datasets = [];
    let i = 0;
    for (const loc of locArr) {
        datasets = datasets.concat([
            {
                label: `${loc["meta"]["name"]}`,
                data: loc["weather"]["daylight"],
                backgroundColor: COLORS[i][0],
                borderColor: COLORS[i][1]
            }
        ])
        i += 1;
    }
    return datasets;
}

const sampleArray = [
    {
        "meta": {
            "id": 5380748,
            "name": "Palo Alto",
            "latitude": 37.4,
            "longitude": -122.1,
            "elevation": 11,
            "feature_code": "PPL",
            "country_code": "US",
            "admin1_id": 5332921,
            "admin2_id": 5393021,
            "timezone": "America/Los_Angeles",
            "population": 66853,
            "postcodes": [
                "94301",
                "94302",
                "94304",
                "94306",
                "94309"
            ],
            "country_id": 6252001,
            "country": "United States",
            "admin1": "California",
            "admin2": "Santa Clara",
            "generationtime_ms": 1.2450218200683594,
            "utc_offset_seconds": -25200,
            "timezone_abbreviation": "PDT",
            "daily_units": {
                "time": "iso8601",
                "temperature_2m_max": "°C",
                "temperature_2m_min": "°C",
                "precipitation_sum": "mm",
                "snowfall_sum": "cm",
                "rain_sum": "mm",
                "sunrise": "iso8601",
                "sunset": "iso8601"
            }
        },
        "weather": {
            "time": [
                "2023-01-01",
                "2023-01-02",
                "2023-01-03",
                "2023-01-04",
                "2023-01-05",
                "2023-01-06",
                "2023-01-07",
                "2023-01-08",
                "2023-01-09",
                "2023-01-10",
                "2023-01-11",
                "2023-01-12",
                "2023-01-13",
                "2023-01-14",
                "2023-01-15",
                "2023-01-16",
                "2023-01-17",
                "2023-01-18",
                "2023-01-19",
                "2023-01-20",
                "2023-01-21",
                "2023-01-22",
                "2023-01-23",
                "2023-01-24",
                "2023-01-25",
                "2023-01-26",
                "2023-01-27",
                "2023-01-28",
                "2023-01-29",
                "2023-01-30",
                "2023-01-31",
                "2023-02-01",
                "2023-02-02",
                "2023-02-03",
                "2023-02-04",
                "2023-02-05",
                "2023-02-06",
                "2023-02-07",
                "2023-02-08",
                "2023-02-09",
                "2023-02-10",
                "2023-02-11",
                "2023-02-12",
                "2023-02-13",
                "2023-02-14",
                "2023-02-15",
                "2023-02-16",
                "2023-02-17",
                "2023-02-18",
                "2023-02-19",
                "2023-02-20",
                "2023-02-21",
                "2023-02-22",
                "2023-02-23",
                "2023-02-24",
                "2023-02-25",
                "2023-02-26",
                "2023-02-27",
                "2023-02-28",
                "2023-03-01",
                "2023-03-02",
                "2023-03-03",
                "2023-03-04",
                "2023-03-05",
                "2023-03-06",
                "2023-03-07",
                "2023-03-08",
                "2023-03-09",
                "2023-03-10",
                "2023-03-11",
                "2023-03-12",
                "2023-03-13",
                "2023-03-14",
                "2023-03-15",
                "2023-03-16",
                "2023-03-17",
                "2023-03-18",
                "2023-03-19",
                "2023-03-20",
                "2023-03-21",
                "2023-03-22",
                "2023-03-23",
                "2023-03-24",
                "2023-03-25",
                "2023-03-26",
                "2023-03-27",
                "2023-03-28",
                "2023-03-29",
                "2023-03-30",
                "2023-03-31"
            ],
            "temperature_2m_max": [
                57.74,
                52.16,
                55.58,
                57.74,
                54.68,
                59.72,
                58.82,
                60.62,
                57.379999999999995,
                54.32,
                54.86,
                63.86,
                57.56,
                55.76,
                52.52,
                52.7,
                54.68,
                55.4,
                52.879999999999995,
                52.879999999999995,
                55.4,
                55.76,
                57.379999999999995,
                60.08,
                62.059999999999995,
                64.04,
                59.72,
                54.86,
                49.64,
                52.7,
                56.120000000000005,
                57.92,
                59.72,
                56.120000000000005,
                60.62,
                52.7,
                57.2,
                58.1,
                60.980000000000004,
                65.48,
                55.94,
                53.78,
                61.34,
                58.28,
                49.82,
                54.86,
                55.76,
                59.72,
                62.42,
                63.5,
                65.66,
                54.86,
                48.379999999999995,
                48.2,
                46.4,
                50.54,
                50,
                47.66,
                51.26,
                52.879999999999995,
                56.3,
                55.4,
                49.28,
                51.8,
                52.34,
                51.98,
                54.14,
                51.08,
                55.04,
                59.18,
                59.36,
                63.14,
                59,
                58.64,
                59,
                64.4,
                67.46,
                57.92,
                57.2,
                53.96,
                56.84,
                54.5,
                55.94,
                55.94,
                55.04,
                60.62,
                50.72,
                51.26,
                55.58,
                58.459999999999994
            ],
            "temperature_2m_min": [
                42.8,
                46.22,
                45.68,
                46.94,
                44.6,
                44.6,
                51.08,
                49.28,
                49.46,
                47.84,
                46.94,
                49.28,
                51.8,
                46.94,
                44.6,
                43.34,
                42.8,
                46.4,
                44.42,
                39.02,
                40.64,
                42.620000000000005,
                39.92,
                38.12,
                40.82,
                38.839999999999996,
                46.94,
                45.14,
                42.08,
                35.42,
                38.3,
                37.04,
                41.54,
                48.379999999999995,
                46.4,
                44.78,
                42.980000000000004,
                44.6,
                39.92,
                39.74,
                45.32,
                41.36,
                43.879999999999995,
                45.86,
                39.2,
                38.839999999999996,
                39.56,
                39.56,
                46.22,
                43.7,
                46.4,
                42.620000000000005,
                39.92,
                36.32,
                39.38,
                38.839999999999996,
                42.260000000000005,
                37.4,
                37.58,
                34.7,
                41.36,
                42.620000000000005,
                42.44,
                41.18,
                37.76,
                40.64,
                40.82,
                40.28,
                47.66,
                46.58,
                51.620000000000005,
                51.8,
                47.48,
                41.36,
                45.86,
                47.120000000000005,
                43.519999999999996,
                49.64,
                46.58,
                46.22,
                45.86,
                46.04,
                41,
                39.56,
                39.56,
                44.96,
                43.519999999999996,
                41,
                41,
                44.78
            ],
            "precipitation_sum": [
                0,
                0.24015760999999997,
                0.01968505,
                0.85039416,
                0.60236253,
                0,
                0.40551203,
                0.6850397399999999,
                1.12204785,
                0.9763784799999999,
                0.58267748,
                0.01574804,
                0.54330738,
                1.28346526,
                0.63385861,
                0.69685077,
                0,
                0.01574804,
                0.11417329,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0.04330711,
                0,
                0,
                0,
                0,
                0.18110245999999997,
                0.25590565,
                0.61417356,
                0,
                0,
                0,
                0,
                0.00393701,
                0.10629927,
                0,
                0,
                0.05118113,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0.027559069999999998,
                0.30314977,
                0.88976426,
                0.055118139999999996,
                0.27559069999999997,
                0.6181105699999999,
                0.73228386,
                0.03149608,
                0,
                0,
                0.18897647999999997,
                0.33858286,
                0.09842524999999999,
                0.12204730999999999,
                0.18110245999999997,
                0.91338632,
                0.7559059199999999,
                0.09055122999999998,
                0.18897647999999997,
                0.11417329,
                0.68110273,
                0,
                0,
                0,
                0,
                0.46850419,
                0.03543309,
                1.35433144,
                0.60629954,
                0.011811029999999998,
                0,
                0,
                0,
                0.00393701,
                0.5944885099999999,
                0.6456696399999999,
                0.00393701,
                0
            ],
            "snowfall_sum": [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ],
            "rain_sum": [
                0,
                0.24015760999999997,
                0.01968505,
                0.85039416,
                0.60236253,
                0,
                0.40551203,
                0.6850397399999999,
                1.12204785,
                0.9763784799999999,
                0.58267748,
                0.01574804,
                0.54330738,
                1.28346526,
                0.63385861,
                0.69685077,
                0,
                0.01574804,
                0.11417329,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0.04330711,
                0,
                0,
                0,
                0,
                0.18110245999999997,
                0.25590565,
                0.61417356,
                0,
                0,
                0,
                0,
                0.00393701,
                0.10629927,
                0,
                0,
                0.05118113,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0.027559069999999998,
                0.30314977,
                0.88976426,
                0.055118139999999996,
                0.27559069999999997,
                0.6181105699999999,
                0.73228386,
                0.03149608,
                0,
                0,
                0.18897647999999997,
                0.33858286,
                0.09842524999999999,
                0.12204730999999999,
                0.18110245999999997,
                0.91338632,
                0.7559059199999999,
                0.09055122999999998,
                0.18897647999999997,
                0.11417329,
                0.68110273,
                0,
                0,
                0,
                0,
                0.46850419,
                0.03543309,
                1.35433144,
                0.60629954,
                0.011811029999999998,
                0,
                0,
                0,
                0.00393701,
                0.5944885099999999,
                0.6456696399999999,
                0.00393701,
                0
            ],
            "sunrise": [
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.35,
                8.333333333333334,
                8.333333333333334,
                8.333333333333334,
                8.333333333333334,
                8.316666666666666,
                8.316666666666666,
                8.3,
                8.3,
                8.283333333333333,
                8.283333333333333,
                8.266666666666667,
                8.266666666666667,
                8.25,
                8.233333333333333,
                8.233333333333333,
                8.216666666666667,
                8.2,
                8.2,
                8.183333333333334,
                8.166666666666666,
                8.15,
                8.133333333333333,
                8.116666666666667,
                8.1,
                8.083333333333334,
                8.066666666666666,
                8.05,
                8.033333333333333,
                8.016666666666667,
                8,
                7.983333333333333,
                7.966666666666667,
                7.95,
                7.933333333333334,
                7.9,
                7.883333333333333,
                7.866666666666667,
                7.85,
                7.833333333333333,
                7.8,
                7.783333333333333,
                7.766666666666667,
                7.75,
                7.716666666666667,
                7.7,
                7.666666666666667,
                7.65,
                7.633333333333333,
                7.6,
                7.583333333333333,
                7.566666666666666,
                7.533333333333333,
                7.516666666666667,
                7.483333333333333,
                7.466666666666667,
                7.433333333333334,
                7.416666666666667,
                7.383333333333334,
                7.366666666666666,
                7.35,
                7.316666666666666,
                7.3,
                7.266666666666667,
                7.25,
                7.216666666666667,
                7.2,
                7.166666666666667,
                7.15,
                7.116666666666666,
                7.1,
                7.066666666666666,
                7.05,
                7.016666666666667,
                6.983333333333333,
                6.966666666666667,
                6.933333333333334,
                6.916666666666667,
                6.883333333333333
            ],
            "sunset": [
                18.033333333333335,
                18.05,
                18.066666666666666,
                18.083333333333332,
                18.1,
                18.116666666666667,
                18.133333333333333,
                18.133333333333333,
                18.15,
                18.166666666666668,
                18.183333333333334,
                18.2,
                18.216666666666665,
                18.233333333333334,
                18.25,
                18.266666666666666,
                18.283333333333335,
                18.3,
                18.316666666666666,
                18.333333333333332,
                18.366666666666667,
                18.383333333333333,
                18.4,
                18.416666666666668,
                18.433333333333334,
                18.45,
                18.466666666666665,
                18.483333333333334,
                18.5,
                18.516666666666666,
                18.533333333333335,
                18.566666666666666,
                18.583333333333332,
                18.6,
                18.616666666666667,
                18.633333333333333,
                18.65,
                18.666666666666668,
                18.683333333333334,
                18.7,
                18.716666666666665,
                18.733333333333334,
                18.766666666666666,
                18.783333333333335,
                18.8,
                18.816666666666666,
                18.833333333333332,
                18.85,
                18.866666666666667,
                18.883333333333333,
                18.9,
                18.916666666666668,
                18.933333333333334,
                18.95,
                18.966666666666665,
                18.983333333333334,
                19,
                19.016666666666666,
                19.033333333333335,
                19.05,
                19.066666666666666,
                19.083333333333332,
                19.1,
                19.116666666666667,
                19.133333333333333,
                19.15,
                19.166666666666668,
                19.183333333333334,
                19.2,
                19.216666666666665,
                19.233333333333334,
                19.25,
                19.25,
                19.266666666666666,
                19.283333333333335,
                19.3,
                19.316666666666666,
                19.333333333333332,
                19.35,
                19.366666666666667,
                19.383333333333333,
                19.4,
                19.416666666666668,
                19.433333333333334,
                19.433333333333334,
                19.45,
                19.466666666666665,
                19.483333333333334,
                19.5,
                19.516666666666666
            ],
            "daylight": [
                9.683333333333335,
                9.700000000000001,
                9.716666666666667,
                9.733333333333333,
                9.750000000000002,
                9.766666666666667,
                9.783333333333333,
                9.783333333333333,
                9.799999999999999,
                9.816666666666668,
                9.833333333333334,
                9.85,
                9.883333333333331,
                9.9,
                9.916666666666666,
                9.933333333333332,
                9.966666666666669,
                9.983333333333334,
                10.016666666666666,
                10.033333333333331,
                10.083333333333334,
                10.1,
                10.133333333333331,
                10.15,
                10.183333333333334,
                10.216666666666667,
                10.233333333333333,
                10.266666666666667,
                10.3,
                10.316666666666666,
                10.350000000000001,
                10.4,
                10.433333333333332,
                10.466666666666669,
                10.5,
                10.533333333333333,
                10.566666666666665,
                10.600000000000001,
                10.633333333333333,
                10.666666666666666,
                10.699999999999998,
                10.733333333333334,
                10.783333333333331,
                10.816666666666668,
                10.850000000000001,
                10.883333333333333,
                10.933333333333332,
                10.966666666666669,
                11,
                11.033333333333333,
                11.066666666666666,
                11.116666666666667,
                11.15,
                11.183333333333334,
                11.216666666666665,
                11.266666666666667,
                11.3,
                11.349999999999998,
                11.383333333333335,
                11.416666666666668,
                11.466666666666667,
                11.5,
                11.533333333333335,
                11.583333333333334,
                11.616666666666667,
                11.666666666666664,
                11.700000000000001,
                11.75,
                11.783333333333331,
                11.833333333333332,
                11.866666666666667,
                11.9,
                11.933333333333334,
                11.966666666666665,
                12.01666666666667,
                12.05,
                12.1,
                12.133333333333333,
                12.183333333333334,
                12.216666666666667,
                12.266666666666666,
                12.299999999999999,
                12.350000000000001,
                12.383333333333333,
                12.416666666666668,
                12.466666666666665,
                12.499999999999998,
                12.55,
                12.583333333333332,
                12.633333333333333
            ]
        }
    },
    {
        "meta": {
            "id": 5261457,
            "name": "Madison",
            "latitude": 43.100006,
            "longitude": -89.4,
            "elevation": 272,
            "feature_code": "PPLA",
            "country_code": "US",
            "admin1_id": 5279468,
            "admin2_id": 5250074,
            "admin3_id": 5261482,
            "timezone": "America/Chicago",
            "population": 248951,
            "postcodes": [
                "53701",
                "53702",
                "53703",
                "53704",
                "53705",
                "53706",
                "53707",
                "53708",
                "53711",
                "53713",
                "53714",
                "53715",
                "53716",
                "53717",
                "53718",
                "53719",
                "53725",
                "53726",
                "53744",
                "53777",
                "53778",
                "53779",
                "53782",
                "53783",
                "53784",
                "53785",
                "53786",
                "53788",
                "53789",
                "53790",
                "53791",
                "53792",
                "53793",
                "53794"
            ],
            "country_id": 6252001,
            "country": "United States",
            "admin1": "Wisconsin",
            "admin2": "Dane",
            "admin3": "City of Madison",
            "generationtime_ms": 2.5980472564697266,
            "utc_offset_seconds": -18000,
            "timezone_abbreviation": "CDT",
            "daily_units": {
                "time": "iso8601",
                "temperature_2m_max": "°C",
                "temperature_2m_min": "°C",
                "precipitation_sum": "mm",
                "snowfall_sum": "cm",
                "rain_sum": "mm",
                "sunrise": "iso8601",
                "sunset": "iso8601"
            }
        },
        "weather": {
            "time": [
                "2023-01-01",
                "2023-01-02",
                "2023-01-03",
                "2023-01-04",
                "2023-01-05",
                "2023-01-06",
                "2023-01-07",
                "2023-01-08",
                "2023-01-09",
                "2023-01-10",
                "2023-01-11",
                "2023-01-12",
                "2023-01-13",
                "2023-01-14",
                "2023-01-15",
                "2023-01-16",
                "2023-01-17",
                "2023-01-18",
                "2023-01-19",
                "2023-01-20",
                "2023-01-21",
                "2023-01-22",
                "2023-01-23",
                "2023-01-24",
                "2023-01-25",
                "2023-01-26",
                "2023-01-27",
                "2023-01-28",
                "2023-01-29",
                "2023-01-30",
                "2023-01-31",
                "2023-02-01",
                "2023-02-02",
                "2023-02-03",
                "2023-02-04",
                "2023-02-05",
                "2023-02-06",
                "2023-02-07",
                "2023-02-08",
                "2023-02-09",
                "2023-02-10",
                "2023-02-11",
                "2023-02-12",
                "2023-02-13",
                "2023-02-14",
                "2023-02-15",
                "2023-02-16",
                "2023-02-17",
                "2023-02-18",
                "2023-02-19",
                "2023-02-20",
                "2023-02-21",
                "2023-02-22",
                "2023-02-23",
                "2023-02-24",
                "2023-02-25",
                "2023-02-26",
                "2023-02-27",
                "2023-02-28",
                "2023-03-01",
                "2023-03-02",
                "2023-03-03",
                "2023-03-04",
                "2023-03-05",
                "2023-03-06",
                "2023-03-07",
                "2023-03-08",
                "2023-03-09",
                "2023-03-10",
                "2023-03-11",
                "2023-03-12",
                "2023-03-13",
                "2023-03-14",
                "2023-03-15",
                "2023-03-16",
                "2023-03-17",
                "2023-03-18",
                "2023-03-19",
                "2023-03-20",
                "2023-03-21",
                "2023-03-22",
                "2023-03-23",
                "2023-03-24",
                "2023-03-25",
                "2023-03-26",
                "2023-03-27",
                "2023-03-28",
                "2023-03-29",
                "2023-03-30",
                "2023-03-31"
            ],
            "temperature_2m_max": [
                42.8,
                35.6,
                36.86,
                37.22,
                34.88,
                29.66,
                30.02,
                32.18,
                41.9,
                41.54,
                46.04,
                35.96,
                32,
                34.34,
                41.9,
                45.5,
                44.6,
                36.5,
                36.32,
                30.92,
                28.22,
                27.86,
                31.28,
                36.32,
                32.18,
                29.3,
                34.16,
                18.5,
                15.079999999999998,
                6.979999999999997,
                10.759999999999998,
                24.8,
                24.08,
                5,
                35.42,
                34.88,
                41.54,
                43.7,
                42.260000000000005,
                35.6,
                33.98,
                40.64,
                41.72,
                41.72,
                46.4,
                45.86,
                30.56,
                26.060000000000002,
                39.38,
                46.4,
                41.18,
                32.72,
                29.3,
                33.08,
                23.72,
                35.24,
                38.12,
                40.1,
                44.06,
                50.72,
                37.58,
                40.82,
                45.68,
                47.84,
                45.32,
                44.6,
                46.04,
                37.76,
                32.36,
                34.52,
                37.58,
                27.68,
                32,
                45.68,
                42.8,
                37.04,
                24.62,
                37.58,
                47.3,
                52.16,
                50.18,
                45.14,
                45.86,
                40.46,
                37.76,
                40.28,
                42.08,
                33.26,
                43.34,
                64.58
            ],
            "temperature_2m_min": [
                27.32,
                28.04,
                31.46,
                31.1,
                30.38,
                23.36,
                19.22,
                17.779999999999998,
                21.560000000000002,
                26.96,
                28.76,
                28.76,
                24.26,
                21.2,
                26.060000000000002,
                35.42,
                34.52,
                30.02,
                30.92,
                25.34,
                24.26,
                22.64,
                19.939999999999998,
                24.8,
                24.26,
                16.520000000000003,
                9.14,
                12.559999999999999,
                4.459999999999997,
                -7.420000000000002,
                -21.1,
                0.14000000000000412,
                2.6599999999999966,
                -13,
                -0.5799999999999983,
                20.12,
                6.440000000000001,
                24.8,
                21.74,
                28.4,
                16.520000000000003,
                10.220000000000002,
                19.04,
                25.880000000000003,
                27.5,
                30.74,
                23.36,
                4.640000000000004,
                17.779999999999998,
                32.18,
                25.880000000000003,
                19.22,
                26.78,
                18.86,
                6.620000000000001,
                16.7,
                17.779999999999998,
                29.12,
                29.12,
                33.08,
                27.86,
                27.14,
                26.060000000000002,
                25.52,
                33.26,
                29.12,
                29.66,
                30.74,
                28.22,
                23.36,
                23.18,
                20.66,
                6.620000000000001,
                14.18,
                36.32,
                15.440000000000001,
                11.120000000000001,
                12.559999999999999,
                28.22,
                30.02,
                37.22,
                30.2,
                25.52,
                28.76,
                19.939999999999998,
                15.259999999999998,
                19.04,
                24.98,
                17.06,
                45.14
            ],
            "precipitation_sum": [
                0.03149608,
                0,
                0.42519708,
                0.01574804,
                0.0393701,
                0,
                0,
                0,
                0,
                0.00787402,
                0,
                0.03543309,
                0.00787402,
                0,
                0,
                0.43700810999999995,
                0.05905515,
                0.13385834,
                0.3543309,
                0.01968505,
                0,
                0.07480318999999999,
                0,
                0,
                0.15354339,
                0.0787402,
                0.03543309,
                0.22440957,
                0.055118139999999996,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0.03149608,
                0,
                0.63385861,
                0,
                0,
                0,
                0,
                0.24803162999999998,
                0.03149608,
                0.30314977,
                0.00393701,
                0,
                0,
                0.00393701,
                0.027559069999999998,
                0.6850397399999999,
                0.11023627999999999,
                0.023622059999999997,
                0,
                0,
                0.69291376,
                0.00787402,
                0,
                0,
                0,
                0.01968505,
                0.14566937,
                0.16929143,
                0,
                0.01968505,
                0.33464584999999997,
                0.21653555,
                0.13385834,
                0.16535442,
                0.03543309,
                0,
                0,
                0.44881914,
                0.14173236,
                0.01574804,
                0,
                0,
                0.01574804,
                0.00787402,
                0.09842524999999999,
                0,
                0.71259881,
                0.14566937,
                0,
                0,
                0.027559069999999998,
                0.09842524999999999,
                1.31889835
            ],
            "snowfall_sum": [
                0,
                0,
                0,
                0.5511814,
                2.7559069999999997,
                0,
                0,
                0,
                0,
                0,
                0,
                2.2047256,
                0.5511814,
                0,
                0,
                0,
                0,
                6.0629954,
                23.1496188,
                1.3779534999999998,
                0,
                5.2362233,
                0,
                0,
                10.7480373,
                5.511813999999999,
                2.4803162999999997,
                15.708669899999999,
                3.8582698,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                37.4803352,
                0,
                0,
                0,
                0,
                0,
                0,
                21.220483899999998,
                0.2755907,
                0,
                0,
                0,
                1.9291349,
                29.212614199999997,
                5.511813999999999,
                1.6535442,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                3.0314977,
                4.4094512,
                0,
                0.2755907,
                22.8740281,
                15.1574885,
                9.3700838,
                10.7480373,
                2.4803162999999997,
                0,
                0,
                0,
                6.3385861,
                1.1023628,
                0,
                0,
                0,
                0,
                3.5826791,
                0,
                49.606325999999996,
                3.0314977,
                0,
                0,
                1.6535442,
                0,
                0
            ],
            "rain_sum": [
                0.03149608,
                0,
                0.42519708,
                0.00787402,
                0,
                0,
                0,
                0,
                0,
                0.00787402,
                0,
                0.00393701,
                0,
                0,
                0,
                0.43700810999999995,
                0.05905515,
                0.047244119999999994,
                0.023622059999999997,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0.03149608,
                0,
                0.09842524999999999,
                0,
                0,
                0,
                0,
                0.24803162999999998,
                0.03149608,
                0,
                0,
                0,
                0,
                0.00393701,
                0,
                0.26771668,
                0.03149608,
                0,
                0,
                0,
                0.69291376,
                0.00787402,
                0,
                0,
                0,
                0.01968505,
                0.10236226,
                0.10629927,
                0,
                0.01574804,
                0.00787402,
                0,
                0,
                0.011811029999999998,
                0,
                0,
                0,
                0.44881914,
                0.05118113,
                0,
                0,
                0,
                0.01574804,
                0.00787402,
                0.047244119999999994,
                0,
                0.00393701,
                0.10236226,
                0,
                0,
                0.00393701,
                0.09842524999999999,
                1.31889835
            ],
            "sunrise": [
                8.45,
                8.45,
                8.45,
                8.45,
                8.45,
                8.45,
                8.45,
                8.433333333333334,
                8.433333333333334,
                8.433333333333334,
                8.433333333333334,
                8.416666666666666,
                8.416666666666666,
                8.4,
                8.4,
                8.4,
                8.383333333333333,
                8.366666666666667,
                8.366666666666667,
                8.35,
                8.333333333333334,
                8.333333333333334,
                8.316666666666666,
                8.3,
                8.283333333333333,
                8.266666666666667,
                8.266666666666667,
                8.25,
                8.233333333333333,
                8.216666666666667,
                8.2,
                8.183333333333334,
                8.15,
                8.133333333333333,
                8.116666666666667,
                8.1,
                8.083333333333334,
                8.066666666666666,
                8.033333333333333,
                8.016666666666667,
                8,
                7.983333333333333,
                7.95,
                7.933333333333334,
                7.916666666666667,
                7.883333333333333,
                7.866666666666667,
                7.833333333333333,
                7.816666666666666,
                7.783333333333333,
                7.766666666666667,
                7.733333333333333,
                7.716666666666667,
                7.683333333333334,
                7.666666666666667,
                7.633333333333333,
                7.6,
                7.583333333333333,
                7.55,
                7.533333333333333,
                7.5,
                7.466666666666667,
                7.45,
                7.416666666666667,
                7.383333333333334,
                7.35,
                7.333333333333333,
                7.3,
                7.266666666666667,
                7.25,
                7.216666666666667,
                7.183333333333334,
                7.15,
                7.133333333333334,
                7.1,
                7.066666666666666,
                7.033333333333333,
                7.016666666666667,
                6.983333333333333,
                6.95,
                6.916666666666667,
                6.883333333333333,
                6.866666666666667,
                6.833333333333333,
                6.8,
                6.766666666666667,
                6.75,
                6.716666666666667,
                6.683333333333334,
                6.65
            ],
            "sunset": [
                17.583333333333332,
                17.583333333333332,
                17.6,
                17.616666666666667,
                17.633333333333333,
                17.65,
                17.666666666666668,
                17.683333333333334,
                17.7,
                17.716666666666665,
                17.733333333333334,
                17.766666666666666,
                17.783333333333335,
                17.8,
                17.816666666666666,
                17.833333333333332,
                17.85,
                17.883333333333333,
                17.9,
                17.916666666666668,
                17.933333333333334,
                17.966666666666665,
                17.983333333333334,
                18,
                18.033333333333335,
                18.05,
                18.066666666666666,
                18.1,
                18.116666666666667,
                18.133333333333333,
                18.15,
                18.183333333333334,
                18.2,
                18.216666666666665,
                18.25,
                18.266666666666666,
                18.283333333333335,
                18.316666666666666,
                18.333333333333332,
                18.35,
                18.383333333333333,
                18.4,
                18.416666666666668,
                18.45,
                18.466666666666665,
                18.483333333333334,
                18.516666666666666,
                18.533333333333335,
                18.55,
                18.583333333333332,
                18.6,
                18.616666666666667,
                18.65,
                18.666666666666668,
                18.683333333333334,
                18.7,
                18.733333333333334,
                18.75,
                18.766666666666666,
                18.783333333333335,
                18.816666666666666,
                18.833333333333332,
                18.85,
                18.866666666666667,
                18.9,
                18.916666666666668,
                18.933333333333334,
                18.95,
                18.966666666666665,
                19,
                19.016666666666666,
                19.033333333333335,
                19.05,
                19.066666666666666,
                19.1,
                19.116666666666667,
                19.133333333333333,
                19.15,
                19.166666666666668,
                19.2,
                19.216666666666665,
                19.233333333333334,
                19.25,
                19.266666666666666,
                19.283333333333335,
                19.316666666666666,
                19.333333333333332,
                19.35,
                19.366666666666667,
                19.383333333333333
            ],
            "daylight": [
                9.133333333333333,
                9.133333333333333,
                9.150000000000002,
                9.166666666666668,
                9.183333333333334,
                9.2,
                9.216666666666669,
                9.25,
                9.266666666666666,
                9.283333333333331,
                9.3,
                9.35,
                9.366666666666669,
                9.4,
                9.416666666666666,
                9.433333333333332,
                9.466666666666669,
                9.516666666666666,
                9.533333333333331,
                9.566666666666668,
                9.6,
                9.633333333333331,
                9.666666666666668,
                9.7,
                9.750000000000002,
                9.783333333333333,
                9.799999999999999,
                9.850000000000001,
                9.883333333333335,
                9.916666666666666,
                9.95,
                10,
                10.049999999999999,
                10.083333333333332,
                10.133333333333333,
                10.166666666666666,
                10.200000000000001,
                10.25,
                10.299999999999999,
                10.333333333333334,
                10.383333333333333,
                10.416666666666664,
                10.466666666666669,
                10.516666666666666,
                10.549999999999997,
                10.600000000000001,
                10.649999999999999,
                10.700000000000003,
                10.733333333333334,
                10.799999999999999,
                10.833333333333336,
                10.883333333333333,
                10.933333333333332,
                10.983333333333334,
                11.016666666666666,
                11.066666666666666,
                11.133333333333335,
                11.166666666666668,
                11.216666666666665,
                11.250000000000002,
                11.316666666666666,
                11.366666666666665,
                11.400000000000002,
                11.45,
                11.516666666666666,
                11.566666666666668,
                11.600000000000001,
                11.649999999999999,
                11.7,
                11.75,
                11.799999999999999,
                11.850000000000001,
                11.9,
                11.933333333333334,
                12.000000000000002,
                12.05,
                12.1,
                12.133333333333333,
                12.183333333333334,
                12.25,
                12.299999999999997,
                12.350000000000001,
                12.383333333333333,
                12.433333333333334,
                12.483333333333334,
                12.55,
                12.583333333333332,
                12.633333333333335,
                12.683333333333334,
                12.733333333333333
            ]
        }
    }
]